<div class="row">
  <div class="col-lg-12">
    <form class="form-horizontal form_class" *ngIf="addCustomerForm" role="form" [formGroup]="addCustomerForm"
          autocomplete="off">
      <div class="form_class_fieldset_div">
        <div class="title">Add customer</div>
        <div class="row-fluid row">
          <div class="col-lg-6">
            <fieldset>
              <legend>Customer details</legend>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right required">
                  Company name
                </label>
                <div class="col-md-7">
                  <input type="text" formControlName="company_name" class="form-control"
                         placeholder="Please enter company name">
                  <span *ngIf="addCustomerForm.controls.company_name.errors && (addCustomerForm.controls.company_name.dirty
            || addCustomerForm.controls.company_name.touched)" class="help-block">
            <span [hidden]="!addCustomerForm.controls.company_name.errors.required" class="text-danger">
            Please enter company name
            </span>
            </span>
                </div>
              </div>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right required">
                  Address
                </label>
                <div class="col-md-7">
                  <input type="textarea" formControlName="address" rows="3" class="form-control"
                         placeholder="Please enter address">
                  <span *ngIf="addCustomerForm.controls.address.errors && (addCustomerForm.controls.address.dirty
            || addCustomerForm.controls.address.touched)" class="help-block">
            <span [hidden]="!addCustomerForm.controls.address.errors.required" class="text-danger">
            Please enter address
            </span>
            </span>
                </div>
              </div>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right required">
                  Pincode
                </label>
                <div class="col-md-7">
                  <app-locality-select property="pincode" [relDisCtrl]="addCustomerForm.controls.city"
                                       [relStateCtrl]="addCustomerForm.controls.state"
                                       formControlName="postcode"></app-locality-select>
                  <span *ngIf="addCustomerForm.controls.postcode.errors && (addCustomerForm.controls.postcode.dirty
            || addCustomerForm.controls.postcode.touched)" class="help-block">
            <span [hidden]="!addCustomerForm.controls.postcode.errors.required" class="text-danger">
            Please enter postcode
            </span>
            </span>
                </div>
              </div>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right">
                  City
                </label>
                <div class="col-md-7">
                  <input type="text" formControlName="city" class="form-control" required placeholder="City">
                  <span *ngIf="addCustomerForm.controls.city.errors && (addCustomerForm.controls.city.dirty
            || addCustomerForm.controls.city.touched)" class="help-block">
            <span [hidden]="!addCustomerForm.controls.city.errors.required" class="text-danger">
            Please enter city
            </span>
            </span>
                </div>
              </div>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right required">
                  State
                </label>
                <div class="col-md-7">
                  <input type="text" formControlName="state" class="form-control" placeholder="State">
                  <span *ngIf="addCustomerForm.controls.state.errors && (addCustomerForm.controls.state.dirty
            || addCustomerForm.controls.state.touched)" class="help-block">
            <span [hidden]="!addCustomerForm.controls.state.errors.required" class="text-danger">
            Please enter state
            </span>
            </span>
                </div>
              </div>
              <!--<div class="form-group row">
                  <label class="col-form-label col-md-4 text-md-right required">
                      Country
                  </label>
                  <div class="col-md-7 ">
                      <input type="text" formControlName="country" class="form-control" placeholder="Country">
                      <span *ngIf="addCustomerForm.controls.country.errors && (addCustomerForm.controls.country.dirty
                          || addCustomerForm.controls.country.touched)" class="help-block">
                          <span [hidden]="!addCustomerForm.controls.country.errors.required" class="text-danger">
                              Please enter country
                          </span>
                      </span>
                  </div>
              </div>-->
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right">
                  PAN number
                </label>
                <div class="col-md-4">
                  <input type="text" formControlName="pan_number" class="form-control" placeholder="PAN number">

                </div>
              </div>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right">
                  Logo
                </label>
                <div class="col-md-8">
                  <div class="fileinput fileinput-new" data-provides="fileinput">
                    <div class="fileinput-new thumbnail" data-trigger="fileinput">
                      <img style="width: 200px; height: 150px;" id="vendorlogoid" alt="..."
                           src="./../../../assets/img/noimage.jpg">
                    </div>
                    <div>
                      <input hidden name="filename" id="imageFile" type="file" (change)="uploadImageFile($event)">
                      <button type="button" style="background-color: #f8f8f8; width: 122px;"
                              (click)="openImageFile($event)" class="btn btn-default">
                        Select logo
                      </button>
                    </div>
                  </div>
                  <span *ngIf="logoError" class="text-danger help-block">
            {{logoError}}
            </span>
                </div>
              </div>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right required">
                  Customer vertical
                </label>
                <div class="col-md-7">
                  <ng-select [allowClear]="true" [items]="customerItems" (data)="customerRefreshValue($event)"
                             (selected)="customerSelected($event)" (removed)="customerRemoved($event)"
                             (typed)="customerTyped($event)" placeholder="Focused Customer"
                             formControlName="customer_vertical">
                  </ng-select>
                  <span *ngIf="addCustomerForm.controls.customer_vertical.errors && (addCustomerForm.controls.customer_vertical.dirty
            || addCustomerForm.controls.customer_vertical.touched)" class="help-block">
            <span [hidden]="!addCustomerForm.controls.customer_vertical.errors.required" class="text-danger">
            Please select customer vertical
            </span>
            </span>
                </div>
              </div>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right required">
                  Segment
                </label>
                <div class="col-md-7">
                  <ng-select [allowClear]="true" [items]="segmentItems" (data)="customerRefreshValue($event)"
                             (selected)="customerSelected($event)" (removed)="customerRemoved($event)"
                             (typed)="customerTyped($event)" placeholder="choose segment" formControlName="segment">
                  </ng-select>
                </div>
              </div>

              <div class="form-group row">
                      <label class="col-md-4 col-form-label text-md-right required">
                         Delivery Address
                      </label>
                      <div class="col-md-7" *ngIf="deliverySequenceItems">
                          <select formControlName="delivery_sequence" class="form-control">
                              <option value="">select</option>
                              <option *ngFor=" let detail of deliverySequenceItems" class="form-control"  value="{{detail.dDSEQ}}" >
                                  {{detail.dDSEQ}}
                              </option>
                          </select>
                          <span *ngIf="addCustomerForm.controls.delivery_sequence.errors && (addCustomerForm.controls.delivery_sequence.dirty
                          || addCustomerForm.controls.delivery_sequence.touched)" class="help-block">
                          <span [hidden]="!addCustomerForm.controls.delivery_sequence.errors.required" class="text-danger">
                          Please select delivery Address
                          </span>
                          </span>
                      </div>
                  </div>
              <div *ngIf="deliverySequenceItems">
                <div *ngFor="let detail of deliverySequenceItems">
                  <div *ngIf="addCustomerForm.controls.delivery_sequence.value == detail['dDSEQ']"
                       class="form-group row">
                    <div class="col-md-4"></div>
                    <div class="col-md-6 inline-address">
                      <span>{{ detail.cCustomerName }}</span>
                      <span>{{ detail.cAddress1 }}, {{ detail.cAddress2 }}</span>
                      <span>{{ detail.cAddress3 }}, {{ detail.cCity }}</span>
                    </div>
                  </div>
                </div>
              </div>


            </fieldset>
          </div>

          <div class="col-lg-6">
            <fieldset>
              <legend>Primary contact</legend>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right required">
                  Name
                </label>
                <div class="col-md-7">
                  <input type="text" formControlName="contact_name" class="form-control" placeholder="Name">
                  <span *ngIf="addCustomerForm.controls.contact_name.errors && (addCustomerForm.controls.contact_name.dirty
            || addCustomerForm.controls.contact_name.touched)" class="help-block">
            <span [hidden]="!addCustomerForm.controls.contact_name.errors.required" class="text-danger">
            Please enter contact name
            </span>
            </span>
                </div>
              </div>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right">
                  Position
                </label>
                <div class="col-md-7">
                  <input type="text" formControlName="position" class="form-control"
                         placeholder="Please enter position">
                </div>
              </div>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right required">
                  Email
                </label>
                <div class="col-md-7">
                  <input type="text" formControlName="email" class="form-control" placeholder="Please enter email">
                  <control-messages [control]="addCustomerForm.controls.email"></control-messages>
                </div>
              </div>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right required">
                  Mobile
                </label>
                <div class="col-md-4">
                  <input type="text" formControlName="mobile" class="form-control" placeholder="Please enter mobile">
                  <control-messages [control]="addCustomerForm.controls.mobile"></control-messages>
                </div>
              </div>
            </fieldset>
            <fieldset class="margin-top-2">
              <legend>Secondary contact (Optional)</legend>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right text-md-right">
                  Name
                </label>
                <div class="col-md-7">
                  <input type="text" formControlName="optional_contact_name" class="form-control"
                         placeholder="Please enter name">
                </div>
              </div>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right">
                  Position
                </label>
                <div class="col-md-7">
                  <input type="text" formControlName="optional_contact_position" class="form-control"
                         placeholder="Please enter position">
                </div>
              </div>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right">
                  Email
                </label>
                <div class="col-md-7">
                  <input type="text" formControlName="optional_contact_email" class="form-control"
                         placeholder="Please enter email">
                </div>
              </div>
              <div class="form-group row">
                <label class="col-md-4 col-form-label text-md-right">
                  Mobile
                </label>
                <div class="col-md-4">
                  <input type="text" formControlName="optional_contact_mobile" class="form-control"
                         placeholder="Please enter mobile">
                </div>
              </div>
            </fieldset>
          </div>

          <!--Cloud account form-->
          <div
            *ngIf="additionalRequirements.titles.indexOf('cloud_account') >= 0 && addCustomerForm.controls | keys | array_contains:'cloud_account'"
            class="col-lg-12">
            <legend>Cloud account details ({{ additionalRequirements.cloud_account.account_type[1] }})</legend>

            <div formGroupName="cloud_account" class="row">
              <div *ngIf=" additionalRequirements.cloud_account['state'] == 'questing'" class="col-lg-8">
                <div class="form-group row">
                  <label class="col-lg-6">Does the customer have an existing {{
                    additionalRequirements.cloud_account.account_type[1] }} account?</label>
                  <div class="col-md-4">
                    <button (click)="prepareCloudAccountForm(true)" class="btn btn-primary btn-sm">Yes</button>
                    <button (click)="prepareCloudAccountForm(false)" class="btn btn-inverse btn-sm">No</button>
                  </div>
                </div>
              </div>
              <div *ngIf=" additionalRequirements.cloud_account['state'] == 'data_entry'" class="col-lg-6">
                <fieldset formGroupName="details">
                  <legend class="no-border"></legend>
                  <!--Form for non existing accounts-->
                  <div [hidden]="additionalRequirements.cloud_account['account_exists']"
                       [ngSwitch]="additionalRequirements.cloud_account['account_type'][0]">
                    <div *ngSwitchCase="'AWS'">
                      <!--Preferred username input-->
                      <div class="form-group row">
                        <label for="normal-field" class="col-md-5 col-form-label text-md-right required">Preferred
                          Username</label>
                        <div class="col-md-6">
                          <input type="text" formControlName="preferred_username" class="form-control"
                                 placeholder="Please enter Preferred username">
                          <control-messages
                            [control]="addCustomerForm.controls.cloud_account.controls.details.controls.preferred_username"></control-messages>
                        </div>
                      </div>
                    </div>
                    <div *ngSwitchCase="'MS'">
                      <!--Message-->
                      <div class="form-group">
                        <label for="normal-field" class="col-md-12 col-form-label text-md-right required">
                          We will create a {{ additionalRequirements.cloud_account.account_type[1] }} account during
                          provisioning
                        </label>
                      </div>
                    </div>
                    <!--Link to get existing account form -->
                    <div class="form-group row">
                      <label class="col-md-5"></label>
                      <div class="col-md-6">
                        <small><a href="javascript:void(0)" (click)="prepareCloudAccountForm(true)">Already have an
                          account?</a></small>
                      </div>
                    </div>
                  </div>

                  <!--Form for existing accounts-->
                  <div [hidden]="!additionalRequirements.cloud_account['account_exists']"
                       [ngSwitch]="additionalRequirements.cloud_account['account_type'][0]">
                    <div *ngSwitchCase="'AWS'">
                      <!--Account id input-->
                      <div class="form-group row">
                        <label for="normal-field" class="col-md-5 col-form-label text-md-right required">Account
                          Id</label>
                        <div class="col-md-6">
                          <input type="text" formControlName="account_id" class="form-control"
                                 placeholder="Please enter Account Id">
                          <control-messages
                            [control]="addCustomerForm.controls.cloud_account.controls.details.controls.account_id"></control-messages>
                        </div>
                      </div>
                    </div>
                    <div *ngSwitchCase="'MS'">
                      <!--Domain Name input-->
                      <div class="form-group row">
                        <label for="normal-field" class="col-md-5 col-form-label text-md-right required">Domain
                          Name</label>
                        <div class="col-md-6">
                          <input type="text" formControlName="domain_name" class="form-control"
                                 placeholder="Please enter domain name">
                          <control-messages
                            [control]="addCustomerForm.controls.cloud_account.controls.details.controls.domain_name"></control-messages>
                          Invalid_domain

                        </div>
                      </div>
                    </div>
                    <!--Link to get non existing account form-->
                    <div class="form-group row">
                      <label class="col-md-5"></label>
                      <div class="col-md-6">
                        <small><a href="javascript:void(0)" (click)="prepareCloudAccountForm(false)">Don't have account
                          yet?</a></small>
                      </div>
                    </div>
                  </div>
                </fieldset>
              </div>
            </div>
          </div>

        </div>
      </div>
      <div class="form-actions new-actions1">
        <button type="submit" class="btn btn-primary" (click)="saveCustomer()"
                [disabled]="!addCustomerForm.valid || process == 'saving'">
          <span *ngIf="process != 'saving'">Save </span>
          <span *ngIf="process == 'saving'">
    Saving <i class="fa fa-spinner fa-spin"></i>
    </span>
        </button>
        <button type="button" class="btn btn-inverse" [routerLink]="returnPath">Cancel</button>
      </div>
    </form>
  </div>
</div>
